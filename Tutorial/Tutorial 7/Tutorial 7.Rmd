---
title: "STOR 320 Tutorial 7"
author: "Mario Giacomazzo"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning=F)
options(scipen=999)
library(tidyverse)    #Essential Functions
library(rvest)        #Read Tables From Webpages
```

# Introduction

In this tutorial, we will learn how to scrape the web for information. We will look at data spread across multiple websites that is worthy to be joined and analyzed. The R package `rvest` was developed by Hadley Wickham to provide a user-friendly web scraping experience. Combining `rvest` with a CSS selector tool, such as [SelectorGadget](https://selectorgadget.com/), or built-in browser developer tools, makes this entire process more efficient and less painful. This tutorial, prescribed by Dr. Mario, will be guided and completed in stages during class. The following lists contain a lot more information that should be observed and cherished. The truths I will bestow upon you are inspired by many of the works below.

* Blog Tutorials for Web Scraping in R Using `library(rvest)`.
    + **[Blog 1](http://blog.corynissen.com/2015/01/using-rvest-to-scrape-html-table.html)**
    + **[Blog 2](https://blog.rstudio.com/2014/11/24/rvest-easy-web-scraping-with-r/)**
    + **[Blog 3](http://categitau.com/using-rvest-to-scrape-data-from-wikipedia/)**
    + **[Blog 4](https://stat4701.github.io/edav/2015/04/02/rvest_tutorial/)**
    + **[Blog 5](https://www.analyticsvidhya.com/blog/2017/03/beginners-guide-on-web-scraping-in-r-using-rvest-with-hands-on-knowledge/)**
    
* Video Tutorials for Web Scraping in R Using `library(rvest)`
    +  **[Video 1](https://www.youtube.com/watch?v=4IYfYx4yoAI)**
    +  **[Video 2](https://www.youtube.com/watch?v=9ATgpE0yTxA)**
    +  **[Video 3](https://www.youtube.com/watch?v=gSbuwYdNYLM)**

* Information on Open Source SelectorGadget
    + **[Blog](https://cran.r-project.org/web/packages/rvest/vignettes/selectorgadget.html)**
    + **[Video](https://www.youtube.com/watch?v=A5LIHrpZBnY)**



# Part 1: Violent Crimes in US Cities

When I was a little boy, my teachers frowned on any information that was cited from online sources. In the early stages of [Wikipedia](https://www.wikipedia.org/), instructors considered it unreliable due to its *openly editable* format. In academia, Wikipedia is not found in research citations, but is often a first stop in the investigation on almost any topic in any field. A 
search may not give you all the information you want, but you will often be provided with helpful links to the source of the information. The search for [Wikipedia](https://en.wikipedia.org/wiki/Wikipedia) on Wikipedia provides you with a historical overview including positives and negatives.

Many Wikipedia pages contain information organized in tables. Consider the [US Crime Rates](https://en.wikipedia.org/wiki/List_of_United_States_cities_by_crime_rate#Crime_rates_per_100.2C000_people_.282012.29) table that provides the crime rates per 100,000 people for major metropolitan areas in the United States. Statistics are given for violent crimes, property crimes and arson. We desire to convert the HTML table into an R data frame object so we can utilize this information in future analysis.

##Chunk 1: Initial Web Scraping Attempt

Using `rvest` functions such as `read_html()` and `html_table()`, we create a data frame called `VIOLENT` that contains all information read from the desired Wikipedia page.

```{r}
URL.VIOLENT="https://en.wikipedia.org/wiki/List_of_United_States_cities_by_crime_rate#Crime_rates_per_100.2C000_people_.282012.29"
VIOLENT = URL.VIOLENT %>%
  read_html() %>%
  html_table(fill=T) %>%
  .[[2]]
str(VIOLENT)
```

##Chunk 2: Initial Selection of Violent Crimes and Cleaning

```{r}
VIOLENT2=VIOLENT[-1,1:8]
colnames(VIOLENT2)=c("State","City","Population","Total","Murder","Rape","Robbery","Assault")
head(VIOLENT2)
```

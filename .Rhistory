theme_minimal()+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ggplot(T3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)))+
geom_point(aes(x=Alice[1],y=Alice[2]),shape="A",size=8)+
theme_minimal()+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ggplot(T3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)))+
geom_point(aes(x=Alice[1],y=Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(min(T2$Family),max(T2$Family))+
ylim(min(T2$Fare),max(T2$Fare))
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ggplot(T3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)))+
geom_point(aes(x=Alice[1],y=Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(min(T2$Family),max(T2$Family))+
ylim(min(T2$Fare),max(T2$Fare))
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ggplot(T3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)))+
geom_point(aes(x=Alice[1],y=Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(min(T2$Family),max(T2$Family))+
ylim(min(T2$Fare),max(T2$Fare))
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ggplot(T3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)))+
geom_point(aes(x=Alice[1],y=Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(min(T2$Family),max(T2$Family))+
ylim(min(T2$Fare),max(T2$Fare))+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
mean.Family=mean(T2$Family)
sd.Family=sd(T2$Family)
mean.Fare=mean(T2$Fare)
sd.Fare=sd(T2$Fare)
mean.Family
sd.Family
mean.Fare
sd.Fare
T2 %>%
mutate(Family=(Family-mean.Family)/sd.Family,
Fare=(Fare-mean.Fare)/sd.Fare)
ST3= T2 %>%
mutate(Family=(Family-mean.Family)/sd.Family,
Fare=(Fare-mean.Fare)/sd.Fare)
Z.Alice=(Alice-c(mean.Family,mean.Fare))/c(sd.Family,sd.Fare)
Z.Alice
mean.Family=mean(T2$Family)
sd.Family=sd(T2$Family)
mean.Fare=mean(T2$Fare)
sd.Fare=sd(T2$Fare)
ST3= T2 %>%
mutate(Family=(Family-mean.Family)/sd.Family,
Fare=(Fare-mean.Fare)/sd.Fare)
Z.Alice=(Alice-c(mean.Family,mean.Fare))/c(sd.Family,sd.Fare)
ggplot(ST3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),alpha=c(0.3))+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ST3
mean(T2$Family)
sd(T2$Family)
mean(T2$Fare)
sd(T2$Fare)
hist(ST3$Fare)
mean(ST3)
mean(ST3$Fare)
mean(ST3$Family)
sd(ST3$Family)
sd(ST3$Fare)
mean.Family=mean(T2$Family)
sd.Family=sd(T2$Family)
mean.Fare=mean(T2$Fare)
sd.Fare=sd(T2$Fare)
ST3= T2 %>%
mutate(Family=(Family-mean.Family)/sd.Family,
Fare=(Fare-mean.Fare)/sd.Fare)
Z.Alice=(Alice-c(mean.Family,mean.Fare))/c(sd.Family,sd.Fare)
ggplot(ST3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),alpha=c(0.3))+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ggplot(ST3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),alpha=c(0.3))+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlab("Standardized Family")+
ylab("Standardized Fare")
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ggplot(ST3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),alpha=c(0.3))+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlab("Standardized Family")+
ylab("Standardized Fare")
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
Z.Alice=(Alice-c(mean.Family,mean.Fare))/c(sd.Family,sd.Fare)
ggplot(ST3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),alpha=c(0.3))+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlab("Standardized Family")+
ylab("Standardized Fare")+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
mean.Family=mean(T2$Family)
sd.Family=sd(T2$Family)
mean.Fare=mean(T2$Fare)
sd.Fare=sd(T2$Fare)
ST3= T2 %>%
mutate(Family=(Family-mean.Family)/sd.Family,
Fare=(Fare-mean.Fare)/sd.Fare)
Z.Alice=(Alice-c(mean.Family,mean.Fare))/c(sd.Family,sd.Fare)
ggplot(ST3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),alpha=c(0.3))+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlab("Standardized Family")+
ylab("Standardized Fare")+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ST4=ST3 %>%
mutate(d=apply(select(ST3,Family,Fare),1,dist.func,point2=Alice)) %>%
arrange(d) %>%
filter(rank(d,ties.method="min")<=k)
print(ST3)
k
ST4=ST3 %>%
mutate(d=apply(select(ST3,Family,Fare),1,dist.func,point2=Z.Alice)) %>%
arrange(d) %>%
filter(rank(d,ties.method="min")<=k)
print(ST3)
select(ST3,Family,Fare)
Z.Alice
ST3 %>%
mutate(d=apply(select(ST3,Family,Fare),1,dist.func,point2=Z.Alice)) %>%
arrange(d)
ST4=ST3 %>%
mutate(d=apply(select(ST3,Family,Fare),1,dist.func,point2=Z.Alice)) %>%
arrange(d) %>%
filter(rank(d,ties.method="min")<=k)
print(ST4)
select(ST3,Family,Fare)
T2
print(ST4 %>%
mutate(Family=sd.Family*Family+mean.Family,
Fare=sd.Fare*Fare+mean.Fare)
)
ggplot(ST4) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)))+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(min(ST2$Family),max(ST2$Family))+
ylim(min(ST2$Fare),max(ST2$Fare))+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
ST4=ST3 %>%
mutate(d=apply(select(ST3,Family,Fare),1,dist.func,point2=Z.Alice)) %>%
arrange(d) %>%
filter(rank(d,ties.method="min")<=k)
print(ST4 %>%
mutate(Family=sd.Family*Family+mean.Family,
Fare=sd.Fare*Fare+mean.Fare)
)
ggplot(ST4) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)))+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(min(ST3$Family),max(ST3$Family))+
ylim(min(ST3$Fare),max(ST3$Fare))+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
mean.Family=mean(T2$Family)
sd.Family=sd(T2$Family)
mean.Fare=mean(T2$Fare)
sd.Fare=sd(T2$Fare)
ST3= T2 %>%
mutate(Family=(Family-mean.Family)/sd.Family,
Fare=(Fare-mean.Fare)/sd.Fare)
Z.Alice=(Alice-c(mean.Family,mean.Fare))/c(sd.Family,sd.Fare)
ggplot(ST3) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),alpha=c(0.3))+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(-1,10)+
ylim(-1,10)+
xlab("Standardized Family")+
ylab("Standardized Fare")+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
k=300
ST5=ST3 %>%
mutate(d=apply(select(ST3,Family,Fare),1,dist.func,point2=Z.Alice)) %>%
arrange(d) %>%
filter(rank(d,ties.method="min")<=k)
ggplot(ST5) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),size=4)+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(-1,10)+
ylim(-1,10)+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
table(ST5$Survived)
table(ST5$Survived) %>% prop.table()
k=500
ST5=ST3 %>%
mutate(d=apply(select(ST3,Family,Fare),1,dist.func,point2=Z.Alice)) %>%
arrange(d) %>%
filter(rank(d,ties.method="min")<=k)
ggplot(ST5) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),size=4)+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(-1,10)+
ylim(-1,10)+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
KNN.PREDICT=table(ST5$Survived)
KNN.PREDICT
table(ST5$Survived) %>% max()
table(ST5$Survived) %>% which.max()
print(KNN.PREDICT)
library(class)
factor(ST3$Survived,levels=c(0="Died",1="Survived")
factor(ST3$Survived,levels=c(0="Died",1="Survived"))
actor(ST3$Survived,levels=c(0=="Died",1=="Survived"))
factor(ST3$Survived,levels=c(0=="Died",1=="Survived"))
factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived"))
knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
k
k=1
knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
ggplot(ST4) +
geom_point(aes(x=Family,y=Fare,color=factor(Survived)),size=4)+
geom_point(aes(x=Z.Alice[1],y=Z.Alice[2]),shape="A",size=8)+
theme_minimal()+
xlim(-1,10)+
ylim(-1,10)+
theme(text=element_text(size=20)) +
guides(color=guide_legend(title="Survived"))
cv.out=knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
cv.out=knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
sum(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))
sum(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))/length(cv.out)
percent.correct=sum(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))/length(cv.out)
percent.correct
correct=sum(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))/length(cv.out)
correct
mean(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))
possible.k=1:15
accuracy.k=rep(NA,15)
for(k in 1:15){
cv.out=knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
correct=mean(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))
accuracy.k[k]=correct
}
accuracy.
accuracy.k
possible.k=1:300
accuracy.k=rep(NA,15)
for(k in 1:15){
cv.out=knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
correct=mean(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))
accuracy.k[k]=correct
}
ggplot(data=tibble(possible.k,accuracy.k)) +
geom_line(aes(x=possible.k,y=accuracy.k))
possible.k=1:300
accuracy.k=rep(NA,15)
for(k in 1:15){
cv.out=knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
correct=mean(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))
accuracy.k[k]=correct
}
ggplot(data=tibble(possible.k,accuracy.k)) +
geom_line(aes(x=possible.k,y=accuracy.k))
tibble(possible.k,accuracy.k)
possible.k
accuracy.k
possible.k=1:300
accuracy.k=rep(NA,300)
for(k in 1:15){
cv.out=knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
correct=mean(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))
accuracy.k[k]=correct
}
ggplot(data=tibble(possible.k,accuracy.k)) +
geom_line(aes(x=possible.k,y=accuracy.k))
warning()
accuracy.k
possible.k=1:300
accuracy.k=rep(NA,300)
for(k in 1:300){
cv.out=knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
correct=mean(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))
accuracy.k[k]=correct
}
ggplot(data=tibble(possible.k,accuracy.k)) +
geom_line(aes(x=possible.k,y=accuracy.k))
possible.k=1:250
accuracy.k=rep(NA,250)
for(k in 1:250){
cv.out=knn.cv(train=select(ST3,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")),
k=k)
correct=mean(cv.out==factor(ST3$Survived,levels=c(0,1),labels=c("Died","Survived")))
accuracy.k[k]=correct
}
ggplot(data=tibble(possible.k,accuracy.k)) +
geom_line(aes(x=possible.k,y=accuracy.k))
ggplot(data=tibble(possible.k,accuracy.k)) +
geom_line(aes(x=possible.k,y=accuracy.k),color="lightskyblue2",size=2) +
theme_minimal() +
xlab("Choice of k") +
ylab("Percentage of Accurate Predictions")
which.max(accuracy.k)
possible.k[which.max(accuracy.k)]
#4.3
best.k=which.max(accuracy.k)
#4.3
best.k=which.max(accuracy.k)
TEST=titanic_test[,c("SibSp","Parch","Fare")]
TEST
titanic_test[,c("SibSp","Parch","Fare")] %>%
mutate(Family=SibSp+Parch) %>%
select(-SibSp,-Parch)
titanic_test[,c("SibSp","Parch","Fare")] %>%
mutate(Family=SibSp+Parch) %>%
select(-SibSp,-Parch) %>%
mutate(Z.Fare=(Fare-mean.Fare)/sd.Fare,
Z.Family=(Family-mean.Family)/sd.Family)
titanic_test[,c("SibSp","Parch","Fare")] %>%
mutate(Family=SibSp+Parch) %>%
select(-SibSp,-Parch) %>%
mutate(Fare=(Fare-mean.Fare)/sd.Fare,
Family=(Family-mean.Family)/sd.Family)
titanic_test[,c("SibSp","Parch","Fare")] %>%
mutate(Family=SibSp+Parch) %>%
select(-SibSp,-Parch) %>%
mutate(Fare=(Fare-mean.Fare)/sd.Fare,
Family=(Family-mean.Family)/sd.Family)
select(ST3,Family,Fare)
TEST
TEST = titanic_test[,c("SibSp","Parch","Fare")] %>%
mutate(Family=SibSp+Parch) %>%
select(-SibSp,-Parch) %>%
mutate(Fare=(Fare-mean.Fare)/sd.Fare,
Family=(Family-mean.Family)/sd.Family)
TEST
ST3
select(ST3,Family,Fare)
select(TEST,Family,Fare)
TEST %>%
mutate(Predict=knn(train=select(ST3,Family,Fare),
test=select(TEST,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),
labels=c("Died","Survived")),
k=best.k))
select(TEST,Family,Fare)
best.k=which.max(accuracy.k)
TEST = titanic_test[,c("SibSp","Parch","Fare")] %>%
mutate(Family=SibSp+Parch) %>%
select(-SibSp,-Parch) %>%
mutate(Fare=(Fare-mean.Fare)/sd.Fare,
Family=(Family-mean.Family)/sd.Family) %>%
na.omit()
TEST %>%
mutate(Predict=knn(train=select(ST3,Family,Fare),
test=select(TEST,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),
labels=c("Died","Survived")),
k=best.k))
TEST2 = TEST %>%
mutate(Predict=knn(train=select(ST3,Family,Fare),
test=select(TEST,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),
labels=c("Died","Survived")),
k=best.k))
TEST2
TEST2 = TEST %>%
mutate(Predict=knn(train=select(ST3,Family,Fare),
test=select(TEST,Family,Fare),
cl=factor(ST3$Survived,levels=c(0,1),
labels=c("Died","Survived")),
k=best.k)) %>%
mutate(Family=sd.Family*Family+mean.Family,
Fare=sd.Fare*Fare+mean.Fare)
ggplot(TEST2) +
geom_point(aes(x=Family,y=Fare,color=Predict))
ggplot(TEST2) +
geom_point(aes(x=Family,y=Fare,color=Predict),
size=2,alpha=0.3) +
theme_minimal()
ggplot(TEST2) +
geom_point(aes(x=Family,y=Fare,color=Predict),
size=2,alpha=0.3) +
theme_minimal() +
theme(text=element_text(size=20))
ggplot(TEST2) +
geom_point(aes(x=Family,y=Fare,color=Predict),
size=2,alpha=0.3) +
theme_minimal() +
theme(text=element_text(size=20))
shiny::runApp('Tutorial/Tutorial 17/Previous/beer2burpees')
x=c(172,228,161,163,165,245,206,232,235,
242,206,223,195,195,245,196,177,184)
sort(x)
x[9]
x[10]
(235+242)/2
sort(x)
x[9]
x=sort(x)
x[9]
x[10]
(196+206)/2
median(x)
quantile(x,0.25)
x=sort(x)
x[1:9]
x[10:18]
232+1.5*(232-177)
x=c(244,180,234,170,248,234,193,167,169,
198,175,162,173,195,238,224,201,240)
x=sort(x)
median(x)
x=c(244,180,234,170,248,234,193,167,169,
198,175,162,173,195,238,224,201,240)
x=sort(x)
median(x)
median(x[1:9])
median(x[10:18])
238+1.5*(234-173)
234+1.5*(234-173)
library(tidyverse)
who
who=who
View(who)
knitr::opts_chunk$set(echo = TRUE,warning=F)
options(scipen=999)
library(tidyverse)    #Essential Functions
library(modelr)       #Helpful Functions in Modeling
DATA=read_csv("AirWaterTemp.csv",col_types=cols()) #River Data
Location = 103
DATA %>% filter(L==Location) %>%
ggplot()+
geom_point(aes(x=A,y=W),alpha=0.3)+
geom_smooth(aes(x=A,y=W)) +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE,warning=F)
options(scipen=999)
library(tidyverse)    #Essential Functions
library(modelr)       #Helpful Functions in Modeling
DATA=read_csv("AirWaterTemp.csv",col_types=cols()) #River Data
head(DATA)
ggplot(data=DATA) +
geom_point(aes(x=A,y=W),alpha=0.3)+
geom_smooth(aes(x=A,y=W)) +
theme_minimal()
ggplot(data=DATA) +
geom_point(aes(x=A,y=W),alpha=0.3)+
geom_smooth(aes(x=A,y=W)) +
theme_minimal()
Location = 103
DATA %>% filter(L==Location) %>%
ggplot()+
geom_point(aes(x=A,y=W),alpha=0.3)+
geom_smooth(aes(x=A,y=W)) +
theme_minimal()
(2.58*140/20)^2
(2.575*140/20)^2
shiny::runApp('Tutorial/R Shiny/Gapminder_Start')
runApp('Tutorial/R Shiny/Default')
runApp('Tutorial/R Shiny/Default')
runApp('Tutorial/R Shiny/Gapminder_Start')
runApp('Tutorial/R Shiny/Gapminder_Part1')
runApp('Tutorial/R Shiny/Gapminder_Part3')
